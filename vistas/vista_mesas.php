<?php include "includes/cabecera.php"; ?><div id="vista_mesas">	<h1>		<img height="40px" style="vertical-align: middle;" src="img/homescreen.png" /> 		<?php echo $idioma['mesas_mesas']; ?></h1>	<hr />	<br />	<?php 		/*	Carga el módulo que genera las mesas */	include "vistas/vista_mesas_mesas.php";		?></div><?php /*	Carga el módulo que genera la tabla del top usuarios */include "vistas/vista_mesas_top15.php";?><?php 	/*	Comprueba si estamos sentados en una mesa */	if(isset($mimesa) && !empty($mimesa)){				/*	Carga el módulo del chat */		include "vistas/modulo_chat.php";	}?><script type="text/javascript">	var admin_style = "color: green;";	var Top15 = function(){		this.connect = function(){			var self = this;			$.ajax({				type: 'get',				url: 'funciones/ajax_monopoly.php',				dataType: 'json', 				data:{					'id_usuario' : '<?php echo $_SESSION['id_usuario']; ?>',					'top15' : 'true',					'mesas' : 'true'				},				complete: function(response){					setTimeout(function(){ top15.connect(); }, 500);				},				success: function(response){					var temp = "";										/* Colocamos la tabla del top */					temp += "<tr>";						temp += "<th id='toptitulo1' width='35px'>Pos.</th>";						temp += "<th id='toptitulo2' width='220px'>"+response['idiomas']['glo_usuarios']+"</th>";						temp += "<th id='toptitulo3'>Puntos</th>";						temp += "<th id='toptitulo5' width='35px'>"+response['idiomas']['glo_estado']+"</th>";					temp += "</tr>";										for(var x = 0; x < sizeof(response['usuarios']); x++){						var usr = response['usuarios'][x];						var puntos = 1500 + (usr['rate'] * 10);						temp += "<tr>";							temp += "<td>"+(x + 1)+"</td>";							temp += "<td class='nombre' onclick='javascript:menu_jugador(\""+usr['nombre']+"\");' style='cursor: default!important;'>";								temp += "<span id='tipo_cuenta'><img height='18px' style='vertical-align: middle;' src='http://www.imperdiblesoft.com/img/tipos_cuenta/"+usr['cuenta_nombre']+".png' /></span>";								if(usr['administrador'] >= 1){									temp += "<span id='nombre' style='color: "+usr['color']+";'> "+usr['rango']+" "+usr['nombre']+"</span></td>";								}else{									temp += "<span id='nombre'> "+usr['nombre']+"</span></td>";								}							temp += "</td>";							temp += "<td id='victorias'>"+puntos+"</td>";							temp += "<td><img id='estado' src='"+usr['estado']+"' /></td></tr>";						temp += "</tr>";					}										$("#top15_tabla").html(temp);										$("#usuarios_online").html(response['usuarios_online']);					$("#usuarios_registrados").html(response['usuarios_registrados']);										/*	Colocamos la tabla de mesas */					/*	Cuenta las mesas abiertas */					var mesas_abiertas = 0;					for(var x in response['mesas']){						if(response['mesas'][x]['jugando'] == "img/online.png") mesas_abiertas++;					}										temp = "";					temp += "<tr>";						temp += "<th id='cabecera1'>"+response['idiomas']['glo_mesa']+"</th>";						temp += "<th id='cabecera2'>"+response['idiomas']['glo_usuarios']+"</th>";						temp += "<th id='cabecera3'>"+response['idiomas']['glo_estado']+"</th>";					temp += "</tr>";										/*	Si hay mesas */					if(sizeof(response['mesas']) > 0){												/*	Si no hay mesas abiertas*/						if(mesas_abiertas < 1){							temp += "<tr><td colspan='3'>¿No hay mesas disponibles? Crea tu propia mesa</td></tr>";						}												for(var x=0; x < sizeof(response['mesas']); x++){							temp += "<tr>";								temp += "<td id='mesa"+response['mesas'][x]['id_mesa']+"id'>"+response['mesas'][x]['id_mesa']+"</td>";								temp += "<td id='mesa"+response['mesas'][x]['id_mesa']+"jugadores'>"+response['mesas'][x]['jugadores']+" / 4</td>";								temp += "<td><img id='"+response['mesas'][x]['id_mesa']+"jugando' src='"+response['mesas'][x]['jugando']+"'></td>";								temp += "<td id='mesa"+response['mesas'][x]['id_mesa']+"enlace'><a class='boton' href='entrar_mesa-"+response['mesas'][x]['id_mesa']+"-"+response['idiomas'][response['mesas'][x]['enlace']].replace(/ /g, '_')+"'>"+response['idiomas'][response['mesas'][x]['enlace']]+"</a></td>";							temp += "</tr>";						}					}										/*	Si no hay mesas abiertas */					else{						temp += "<tr><td colspan='3'>¿No hay mesas disponibles? Crea tu propia mesa</td></tr>";					}					$("#tabla_mesas").html(temp);										/*	Si hay mesas creadas, y no estoy sentado en ninguna */					if(sizeof(response['yo']['mesa']) > 0 && response['yo']['mesa'] != 'null'){						$("#crear_mesa").html("<input type='submit' id='crear_mesa' name='crear_mesa' value='"+response['idiomas']['mesas_mimesa']+"' />");					}					else{						$("#crear_mesa").html("<input type='submit' id='crear_mesa' name='crear_mesa' value='"+response['idiomas']['mesas_crear']+"' />");					}				}			});		}	};	var top15 = new Top15();	top15.connect();</script><?php include "includes/pie.php"; ?>